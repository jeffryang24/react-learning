<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Counter reducer</title>
</head>
<body>
    <div id="root"></div>
    <script crossorigin src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script crossorigin src="https://unpkg.com/react@latest/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@latest/umd/react-dom.development.js"></script>
    <script crossorigin src="https://unpkg.com/expect@1.20.2/umd/expect.js"></script>
    <script crossorigin src="https://unpkg.com/redux@latest/dist/redux.js"></script>
    <script crossorigin src="https://wzrd.in/standalone/deep-freeze@latest"></script>
    <script type="text/babel">
        const root = document.getElementById('root');

        const todos = (state = [], action) => {
            switch(action.type) {
                case 'ADD_TODO':
                    return [
                        ...state,
                        {
                            id: action.id,
                            text: action.text,
                            completed: false
                        }
                    ];

                case 'TOGGLE_TODO':
                    return state.map(todo => {
                        if (todo.id !== action.id) {
                            return todo;
                        }

                        return {
                            ...todo,
                            completed: !todo.completed
                        };
                    });

                default:
                    return state;
            }
        };

        const testAddTodo = () => {
            const stateBefore = [];
            const action = {
                type: 'ADD_TODO',
                id: 0,
                text: 'Learn Redux'
            };
            const stateAfter = [
                {
                    id: 0,
                    text: 'Learn Redux',
                    completed: false
                }
            ];

            deepFreeze(stateBefore);
            deepFreeze(action);

            expect(
                todos(stateBefore, action)
            ).toEqual(stateAfter);
        };

        const testToggleTodo = () => {
            const stateBefore = [
                {
                    id: 0,
                    text: 'Learn Redux',
                    completed: false
                },
                {
                    id: 1,
                    text: 'Go Shopping',
                    completed: false
                }
            ];

            const action = {
                type: 'TOGGLE_TODO',
                id: 1
            };

            const stateAfter = [
                {
                    id: 0,
                    text: 'Learn Redux',
                    completed: false
                },
                {
                    id: 1,
                    text: 'Go Shopping',
                    completed: true
                }
            ];

            deepFreeze(stateBefore);
            deepFreeze(action);

            expect(
                todos(stateBefore, action)
            ).toEqual(stateAfter);
        };

        testAddTodo();
        testToggleTodo();
        console.log('All tests passed!');
    </script>
</body>
</html>